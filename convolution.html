<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8"/>
		<meta http-equiv="X-UA-Compatible" content="IE=Edge">
		<title>Edge Detection with Canvas</title>
		<script src="edge-detection.js"></script>
		<style>
			cavas{
				margin:5px;
				border:1px solid #ccc;
				display:block;
				float:left;
				background-color:#eee;
			}
		</style>
	</head>
	<body>
		
		<button onclick="renderOutput();">Render Output</button> <br /><br />
		
		<span style="display:none">
			<input type="text" id="tolerance"  name="tolerance" value="12" style="width:20px;"> Tolerance: (0-100)<br />
			<input type="text" id="levels"  name="levels" value="0" style="width:20px;"> Levels Enhancement: (contrast increase) <br />
			<input type="text" id="offset"  name="offset" value="2" style="width:20px;"> Pixel Offset: (size of line) <br /><br />
		</span>
		
		<canvas id="imageCanvas" width="300" height="300"> </canvas>
		<canvas id="resultimageCanvas" width="300" height="300"> </canvas>
		
		<script>
			var img = new Image();
			img.src="clown.jpg";
		
			var canvas = document.getElementById('imageCanvas');
			var ctx = canvas.getContext('2d');
			var outputCanvas = document.getElementById('resultimageCanvas');
			var ctxOutput = outputCanvas.getContext('2d');
			var imageData = [];
			var diffImage = [];
		
			var imgData = null;
			var width = 300;
			var height = 300;
			var pixelOffset = 0;
			var levels = 0;
			var tolerance = 0;
			
						
			var customKernel = [
			  [4,0,4],
			  [0,-14,0],
			  [4,0,4]];
			
			
			img.onload = function(){
				var x = 0;
				var y = 0;
				ctx.drawImage(img, 0, 0);
			};
			
			var renderOutput = function(){
				//grab all image data (with true flag (last paramter), it converts to grayscale right away)
				imageData = $ED.getPixelData(width, height, ctx, false); 
				
				//convert image to grayscale
				imageData = $ED.convertImage2grayscale(width, height, imageData); 
				
				//we blur the image to initially remove noise artifacts
				imageData = $ED.matrixTransform('blur', 1, width, height, imageData); //apply the chosen effect
				
				//use Sobel convolution kernel to get the gradient for x and y of the image
				imageData = $ED.getGradientApproximation(width, height, imageData);
				
				//output data....
				$ED.renderImage(width, height, imageData, ctxOutput);
				
				
				
				//imageData = $ED.invertImage(width, height, imageData);
				
			};
		</script>
	</body>
</html>
